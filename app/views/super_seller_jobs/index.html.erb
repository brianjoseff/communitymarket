<h1>All Super Seller Jobs</h1>

<table class="ssellerjobs table table-hover">
  <tr>
    <thead>
      <th>Posted</th>
      <th>Status</th>
      <th>Owner</th>
      <th>Estimated Value</th>
      <th colspan="3"></th>
    </thead>
  </tr>
  <% @super_seller_jobs.each do |job| %>
  <tr>
    <td><%= time_ago_in_words(job.created_at) %> ago</td>
    <td><%= job.status_html %></span></td>
    <td><%= job.owner_id == current_user.id ? "You own this job" : job.owner_hidden %></td>
    <td>$<%= job.estimated_value %></td>
    <td><%= link_to "Contact Owner", "#myModal", :class => "contact_owner btn btn-success btn-sm", "data-toggle" => "modal", "data-job-id" => job.id unless job.status != "active" || job.owner_id == current_user.id %>
    </td>
  </tr>
  <% end %>
</table>




<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Send Message to Owner</h4>
      </div>
      <div class="modal-body">
        <%= form_tag "/notify_job_owner", method: "post" do %>
          <%= text_area_tag :sseller_msg, "Hello!\r\rI'm a SuperSeller interested in selling your stuff.\r\rSincerely,\r\r" + current_user.name, :rows => 10 %>
          <%= hidden_field_tag :job_id %>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Close</button>
        <%= submit_tag "Send!", :class => "btn btn-success btn-sm" %>
      </div>
        <% end %>
    </div>
  </div>
</div>

<script>
  $(document).on("click", "a.contact_owner", function(e){
    e.preventDefault();
    var jobId = $(this).data('job-id');
    $('#myModal').show();

    $("#job_id").val(jobId);

  });

</script>